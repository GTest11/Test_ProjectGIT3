#'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' 
#TestCase ID: Matchtemplate buffering API for iOS device
#Description: Buffering API for Match template algorithim
#Author: iPhone8Plus_11
#Date: 
#Version: 5.1.1.4_new

#''''''''''''''''''''AUTOGENERATED CODE - DO NOT MODIFY'''''''''''''''''''' 
import clr,sys,os,time 
from System.Collections.Generic import List
clr.AddReference("MobileScriptingLibrary") 
import MobileScriptingLibrary 
dut = MobileScriptingLibrary.MobileDUT() 
logger = MobileScriptingLibrary.Logger() 
chkpt = MobileScriptingLibrary.CheckPoint() 
config = MobileScriptingLibrary.DeviceConfig() 
args = sys.argv 
scriptPath = os.path.realpath(__file__) 
dut.Configure(args[1],args[2],args[3],args[4],scriptPath) 
logger.Configure(args[1],args[2],args[3],args[4],scriptPath)

#''''''''''''''''''''''''''''''''IMPORTS''''''''''''''''''''''''''''''''''' 
#''''''''''''''''''''''''''''''END IMPORTS''''''''''''''''''''''''''''''''' 

#''''''''''''''''''''''''''''''FOR iOS DEVICE'''''''''''''''''''''''''''''' 
config.DeviceType = "iOS" 
#config.AppName = "com.google.ios.youtube" 
#config.AppName = "com.bskyb.nowtv"  # nowTv app 
#config.AppName = "com.bskyb.skygo"  # Skygo app
config.AppName="in.startv.hotstar"  # For match template buffering alogorithim 



#''''''''''''''''''''''''''''FOR ANDROID DEVICE'''''''''''''''''''''''''''' 
#config.DeviceType = "Android" 
#config.AppPackage = "com.bskyb.nowtv.beta"
#config.AppName = "com.bskyb.nowtv" #ios
#config.CreateNewServer = True
#config.AppActivity = "com.nowtv.view.activity.StartupActivity"
 
       
try: 
    if(dut.InitApp(config)): 
        time.sleep(40)
        logger.Log("App launched.")
        time.sleep(10)
        #dut.Tap(243,807)   ###IPAD First selection before video UI for NowTV
        ############HoughCircle validation################
#        dut.Click(MobileScriptingLibrary.Constants.ElementType.XPath,'//XCUIElementTypeButton[@name="id.ui.navigation.search.button"]')
#        dut.CommitStepResult("Click on Search","PASSED")
#        time.sleep(30)                
#        dut.SendKeys(MobileScriptingLibrary.Constants.ElementType.XPath, '//XCUIElementTypeSearchField[@name="id.navigation.search.text_field"]',"high circle buffering video")
#        time.sleep(10)
#################################
        dut.Tap(115,50)
        time.sleep(10)
        #dut.Tap(70,616)  #### hotstar first selection video
        #time.sleep(30)
        #dut.Tap(1169,453)
        #time.sleep(30)
        #dut.SendAndroidKeyCode ("Keycode_ENTER")
        #time.sleep(10)
        #dut.Tap(265,721)
        #dut.TapElement(ElementType,"Element Id",index)
        reservationRequest = MobileScriptingLibrary.HighPrecisionValidationService.SlotReservationRequest() 
        reservationRequest.AlgorithmCount = 1 
        reservationResponse = dut.ReserveSlotForHPA(reservationRequest) 
        logger.Log("Response - " + reservationResponse.Data.Token)

        request = MobileScriptingLibrary.HighPrecisionValidationService.VideoAnalysisRequest()
        deviceInfo = MobileScriptingLibrary.HighPrecisionValidationService.DeviceInfo()
        algorithmList =List[MobileScriptingLibrary.HighPrecisionValidationService.Algorithm]()
        algorithm = MobileScriptingLibrary.HighPrecisionValidationService.Algorithm()
#################################################        
        #algorithm.Name = "Histogram"
        #algorithm.Params = "eyAgICAicmdiRGV0YWlsc0xpc3QiOiBbewogICAgICAgICJyIjogMTAwLAogICAgICAgICJnIjogMzEsCiAgICAgICAgImIiOiAxNDAsCiAgICAgICAgInBpeGVsQ291bnRUaHJlc2hvbGQiOiA4MAogICAgfSwgewogICAgICAgICJyIjogMjU1LAogICAgICAgICJnIjogMTE2LAogICAgICAgICJiIjogNSwKICAgICAgICAicGl4ZWxDb3VudFRocmVzaG9sZCI6IDgwCiAgICB9LCB7CiAgICAgICAgInIiOiA0MSwKICAgICAgICAiZyI6IDEzOSwKICAgICAgICAiYiI6IDI2LAogICAgICAgICJwaXhlbENvdW50VGhyZXNob2xkIjogODAKICAgIH0sIHsKICAgICAgICAiciI6IDAsCiAgICAgICAgImciOiAxMDEsCiAgICAgICAgImIiOiAyNTUsCiAgICAgICAgInBpeGVsQ291bnRUaHJlc2hvbGQiOiA4MAogICAgfV0sCiAgICAibWFza0RldGFpbHMiOiB7CiAgICAgICAgInhjb3JkIjogNjA4LAogICAgICAgICJ5Y29yZCI6IDMwMywKICAgICAgICAid2lkdGgiOiA2OCwKICAgICAgICAiaGVpZ2h0IjogNTIKICAgIH0KfQ=="
        #algorithmList.Add(algorithm)
#########For houghcircles details#######################
#        algorithm.Name = "HoughCircles" 
#        algorithm.Params = "CuKAiwp7CiAgIm1hc2tEZXRhaWxzIjogewogICAgInhjb3JkIjogNDUyLAogICAgInljb3JkIjogMTgyLAogICAgIndpZHRoIjogNDksCiAgICAiaGVpZ2h0IjogMzYKICB9LAogICJjaXJjbGVUaHJlc2hvbGRzIjogewogICAgImNpcmNsZVBlcmNlbnRhZ2VMb3dMaW1pdCI6IDMwLAogICAgImNpcmNsZVBlcmNlbnRhZ2VVcExpbWl0IjogODUsCiAgICAiY2lyY2xlUmFkaXVzTG93TGltaXQiOiAzMCwKICAgICJjaXJjbGVSYWRpdXNVcExpbWl0IjogNDAsCiAgICAiY2lyY2xlQ2VudGVyWE9mZnNldCI6IDE1LAogICAgImNpcmNsZUNlbnRlcllPZmZzZXQiOiAxOC4wLAogICAgImNpcmNsZUNlbnRlcldpZHRoIjogMzAuMCwKICAgICJjaXJjbGVDZW50ZXJIZWlnaHQiOiAzMC4wCiAgfSwKICAibWlzY1RocmVzaG9sZHMiOiB7CiAgICAiY2FubnlUaHJlc2hvbGQxIjogMzUsCiAgICAiY2FubnlUaHJlc2hvbGQyIjogODAsCiAgICAiaG91Z2hEcCI6IDEuNCwKICAgICJob3VnaE1pbkRpc3QiOiA1MC4wLAogICAgImhvdWdoUGFyYW0xIjogODAuMCwKICAgICJob3VnaFBhcmFtMiI6IDM3LjAsCiAgICAiZGlzdFRyYW5zZm9ybUZpbHRlckRpc3QiOiAzCiAgfQp9"
#        algorithmList.Add(algorithm) 
        #*******************************
        #For Match Template########
        algorithm.Name = "MatchTemplate"
        #algorithm.Params = "ewogICJJbWFnZURhdGEiOiAiLzlqLzRBQVFTa1pKUmdBQkFRRUFZQUJnQUFELzJ3QkRBQWdHQmdjR0JRZ0hCd2NKQ1FnS0RCUU5EQXNMREJrU0V3OFVIUm9mSGgwYUhCd2dKQzRuSUNJc0l4d2NLRGNwTERBeE5EUTBIeWM1UFRneVBDNHpOREwvMndCREFRa0pDUXdMREJnTkRSZ3lJUndoTWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qTC93QUFSQ0FCRkFFc0RBU0lBQWhFQkF4RUIvOFFBSHdBQUFRVUJBUUVCQVFFQUFBQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkFBQWdFREF3SUVBd1VGQkFRQUFBRjlBUUlEQUFRUkJSSWhNVUVHRTFGaEJ5SnhGREtCa2FFSUkwS3h3UlZTMGZBa00ySnlnZ2tLRmhjWUdSb2xKaWNvS1NvME5UWTNPRGs2UTBSRlJrZElTVXBUVkZWV1YxaFpXbU5rWldabmFHbHFjM1IxZG5kNGVYcURoSVdHaDRpSmlwS1RsSldXbDVpWm1xS2pwS1dtcDZpcHFyS3p0TFcydDdpNXVzTER4TVhHeDhqSnl0TFQxTlhXMTlqWjJ1SGk0K1RsNXVmbzZlcng4dlAwOWZiMytQbjYvOFFBSHdFQUF3RUJBUUVCQVFFQkFRQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkVBQWdFQ0JBUURCQWNGQkFRQUFRSjNBQUVDQXhFRUJTRXhCaEpCVVFkaGNSTWlNb0VJRkVLUm9iSEJDU016VXZBVlluTFJDaFlrTk9FbDhSY1lHUm9tSnlncEtqVTJOemc1T2tORVJVWkhTRWxLVTFSVlZsZFlXVnBqWkdWbVoyaHBhbk4wZFhaM2VIbDZnb09FaFlhSGlJbUtrcE9VbFphWG1KbWFvcU9rcGFhbnFLbXFzck8wdGJhM3VMbTZ3c1BFeGNiSHlNbkswdFBVMWRiWDJObmE0dVBrNWVibjZPbnE4dlAwOWZiMytQbjYvOW9BREFNQkFBSVJBeEVBUHdEMGJPS090R0tRa0RxYVF4c2poQnpRckJ4d2FqblRmR2NWV3RKQ0gyR2hnTnZibDRwbFZUM3E4ajdrQjZWazZpQ0xwT2VNMWN1cDFnc1FRZm1JNlVBU0xleE5PWWcyV3F6V0RwTURUVEdkczVyZVBBNTRwc1NGcEtUTkprMElZK3FkeVhVNUhTcmxSc3lINVRpaGdWSWJ2NWdyQ215UXQ1d2RPbWFmSmJxeCtWZ0tuaGpLb0F4elNZRlc1c3pQSWpIdFVHbzIwa3pJaWZkSFd0YnZTRmM5QjFGQUdkSmVXK2wyeXFDcGNpc2Y3YmYzOXlwaCtWQWZTcmo2STA5NnozRTJFNmpMWXJYZ2l0TFNQYkd5bkhmTkRBbGpEQ05RL3dCN0hOT3BGZFpNbFdCK2xITk5BRW1TT0tvTmJ5RTUzR3RHb3BKRWk1WWlnQ21MZVVNQ1dOWGs0VVpxakpjUElma0ZXWVdLSU54NU5TMndKeFIxUHBSbmpHYWhudUk0WFdObkNzM0F6VEVZK3I2ZmUzTndEYnk0R09RS3ltMFhWYzh5TmozTkxlM3VxYWZxRFNNV2FGdW5wVzNwbmlLRzhBamxJVjhZNW9hdHFNVFJiTzZ0WW1FN2s1clhBT090Smtub2NnMHRDWURxclhGdjVyQTVxelJUWUZkWVZpV3FoSm11QUFlQlZxNjNiTUNvN1dMWjh4RklCczhwamRWWDFyQThaeFhBUzN1WVdJMkVFNCt0YnQxek9vSHJVdDVhcmUyVFJNTTVYaW1CVDBpNXQ5WTBwSTVnR2RWd1QzcWhjZUZ3bDRzMERsVkI2Q3MvUVlMelQ5ZGt0eXJlU2M4OXE3VThrMGhESVYyUklwNXdLZWVUbWt5S1hGRFF4MUpSUlRBQ01uQm93QU1Zb29vWUZXYUlOS0dOV0Y0QUZGRkpBTjh0TnhrQ2pkNjA2aWltSkM5cU0wVVVEUC9aIiwKICAiTWF0Y2hTY29yZSI6IDAuMSwKICAibWFza0RldGFpbHMiOiB7CiAgICAieGNvcmQiOiAyODEsCiAgICAieWNvcmQiOiA1OTksCiAgICAid2lkdGgiOiA3NSwKICAgICJoZWlnaHQiOiA2OQogIH0KfQ=="
        algorithm.Params ="ewogICJJbWFnZURhdGEiOiAiLzlqLzRBQVFTa1pKUmdBQkFRRUFZQUJnQUFELzJ3QkRBQWdHQmdjR0JRZ0hCd2NKQ1FnS0RCUU5EQXNMREJrU0V3OFVIUm9mSGgwYUhCd2dKQzRuSUNJc0l4d2NLRGNwTERBeE5EUTBIeWM1UFRneVBDNHpOREwvMndCREFRa0pDUXdMREJnTkRSZ3lJUndoTWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qTC93QUFSQ0FBcUFEQURBU0lBQWhFQkF4RUIvOFFBSHdBQUFRVUJBUUVCQVFFQUFBQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkFBQWdFREF3SUVBd1VGQkFRQUFBRjlBUUlEQUFRUkJSSWhNVUVHRTFGaEJ5SnhGREtCa2FFSUkwS3h3UlZTMGZBa00ySnlnZ2tLRmhjWUdSb2xKaWNvS1NvME5UWTNPRGs2UTBSRlJrZElTVXBUVkZWV1YxaFpXbU5rWldabmFHbHFjM1IxZG5kNGVYcURoSVdHaDRpSmlwS1RsSldXbDVpWm1xS2pwS1dtcDZpcHFyS3p0TFcydDdpNXVzTER4TVhHeDhqSnl0TFQxTlhXMTlqWjJ1SGk0K1RsNXVmbzZlcng4dlAwOWZiMytQbjYvOFFBSHdFQUF3RUJBUUVCQVFFQkFRQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkVBQWdFQ0JBUURCQWNGQkFRQUFRSjNBQUVDQXhFRUJTRXhCaEpCVVFkaGNSTWlNb0VJRkVLUm9iSEJDU016VXZBVlluTFJDaFlrTk9FbDhSY1lHUm9tSnlncEtqVTJOemc1T2tORVJVWkhTRWxLVTFSVlZsZFlXVnBqWkdWbVoyaHBhbk4wZFhaM2VIbDZnb09FaFlhSGlJbUtrcE9VbFphWG1KbWFvcU9rcGFhbnFLbXFzck8wdGJhM3VMbTZ3c1BFeGNiSHlNbkswdFBVMWRiWDJObmE0dVBrNWVibjZPbnE4dlAwOWZiMytQbjYvOW9BREFNQkFBSVJBeEVBUHdEaVd2NExlVUtWRmF0amRSenNwVkJqNlZ5R29OKzk0RmRyNFAwcjdkRXhNbURqZ1Z4T25IbHVkdCtWNmwyNktpTVA1UUMrdFc5VHQ0Tk8waTN1MUNscEcyNC9Db3dVdHJ1V3l2TUFZWXFUVkRXTmR0NWJTM3RUd3NjaXR4N0dyaENMK0l6bkp2NFNhK3VocFZuSGN6b3FyS0FSV2FmRk5vNUdjRWo4YTZpNDhNM0hqb1FyQXpSMmtTOEhIRmVZYTdvTWVqNjQxbVpTMjA0em10UFp3V3hrcFNiMUsyb0VySVBjMTMvaEt5bVMwamxTWGFTTzV4WEY2anA4bHhJcFFuQVBhdXA4TjIxeSsxRExzalhybW9pMUpHczMxSTlmdlpKdGEyTklDVjdpdWUxZzRpUE5lZ3Q0R2wxYnpyaXpmZVZQQnJsZFg4STZ0R0lvcElITzQ3ZDJPS09TN3VKVkZheDJmdzhlKzFqdzY5dkJLSWhqRzR2dDdWdy9qM3cxSjRmdm8zbHVSTTh4T1dEWjUrdGVpK0JQQ2h0dEVhR2VZdzNJVWxjdHgrVmNINDBzYjZUVW5pdVoybThwanR6MnJkdFJSakRXVnpHdGRaVGI4NmlyUytJMmprRWNCSURuSFd1V1dsUEJVais5V01WYVdoMWNxdGMrai9EUGlLeDAzd2dwTXErZVNSeVJtdEh4SHFWdXZoZXoxSnhHUzBpbkxlaE9LOEE4Nlg3SEVQTWZHNGNialhUZUpKcFQ0R0NtVnlBb3dDeDlhMlRPWGwwT3ErSW11eDJtaDJkM3BWNHF6Rk1FUm5yelhsMFBpR1c3bGFTN2JMdHlTVFdYY3l5TnA4S3RJNVVFOEZqVkE5YVQ5N1JtbE9DUC85az0iLAogICJNYXRjaFNjb3JlIjogMC41MiwKICAibWFza0RldGFpbHMiOiB7CiAgICAieGNvcmQiOiAyOTksCiAgICAieWNvcmQiOiAxODQsCiAgICAid2lkdGgiOiA0OCwKICAgICJoZWlnaHQiOiA0MgogIH0KfQ=="
        #"ewogICJJbWFnZURhdGEiOiAiLzlqLzRBQVFTa1pKUmdBQkFRRUFZQUJnQUFELzJ3QkRBQWdHQmdjR0JRZ0hCd2NKQ1FnS0RCUU5EQXNMREJrU0V3OFVIUm9mSGgwYUhCd2dKQzRuSUNJc0l4d2NLRGNwTERBeE5EUTBIeWM1UFRneVBDNHpOREwvMndCREFRa0pDUXdMREJnTkRSZ3lJUndoTWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qSXlNakl5TWpJeU1qTC93QUFSQ0FBdUFERURBU0lBQWhFQkF4RUIvOFFBSHdBQUFRVUJBUUVCQVFFQUFBQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkFBQWdFREF3SUVBd1VGQkFRQUFBRjlBUUlEQUFRUkJSSWhNVUVHRTFGaEJ5SnhGREtCa2FFSUkwS3h3UlZTMGZBa00ySnlnZ2tLRmhjWUdSb2xKaWNvS1NvME5UWTNPRGs2UTBSRlJrZElTVXBUVkZWV1YxaFpXbU5rWldabmFHbHFjM1IxZG5kNGVYcURoSVdHaDRpSmlwS1RsSldXbDVpWm1xS2pwS1dtcDZpcHFyS3p0TFcydDdpNXVzTER4TVhHeDhqSnl0TFQxTlhXMTlqWjJ1SGk0K1RsNXVmbzZlcng4dlAwOWZiMytQbjYvOFFBSHdFQUF3RUJBUUVCQVFFQkFRQUFBQUFBQUFFQ0F3UUZCZ2NJQ1FvTC84UUF0UkVBQWdFQ0JBUURCQWNGQkFRQUFRSjNBQUVDQXhFRUJTRXhCaEpCVVFkaGNSTWlNb0VJRkVLUm9iSEJDU016VXZBVlluTFJDaFlrTk9FbDhSY1lHUm9tSnlncEtqVTJOemc1T2tORVJVWkhTRWxLVTFSVlZsZFlXVnBqWkdWbVoyaHBhbk4wZFhaM2VIbDZnb09FaFlhSGlJbUtrcE9VbFphWG1KbWFvcU9rcGFhbnFLbXFzck8wdGJhM3VMbTZ3c1BFeGNiSHlNbkswdFBVMWRiWDJObmE0dVBrNWVibjZPbnE4dlAwOWZiMytQbjYvOW9BREFNQkFBSVJBeEVBUHdEd1dyVmxqemxIdlZhcnVuUW1TNEJVWndhWXpyb2x4R3VPNHFZcGdaTklnemJxQU1GUlVoSG1oVkJ4NjFEdUJIZ0NtOFZQT21OcW9NbXF6cVVPRFQzQWRSVVc2aWl3SEZMRXg2Q3VuOE82RnFFbzgrT0V0R08vYW8xc2tEWXhYWmVITlIxS05WdExLM1FxZXJGYzBKZ1pGeXJ4U2JIWGF3NmlvUnVCem10blg3VzRndmQxd1F6dnlkb3hpc3Z5K0JpZ0M1YkVlVVRzM05pcWR5cm1UTERGYVZwSElrUmRVejlhcTNjclB3eTQvQ2hhQVVOdEZTNG9wZ1o1NWx4bXVqMHZ4TkxvMXN5Ukw4ekRBSTYxZ3hxTTVvdWZ1ZlRwVUFkNlBLdWRHTi9xRWhhU1RsUVNLekpiR0NHM2hueU1PY1Z5VDZ0Y3ZCSGJ1MlkwNkN0V1hWM21zSTQ5dU5wNHFyanNiRnpLMWk2bE1GR0FOWk54TjVzcE9LcnlYOHM2S3Jub0toODBqbWx6QllueVBTaW9mTzlxS0FQLzJRPT0iLAogICJNYXRjaFNjb3JlIjogMC41LAogICJtYXNrRGV0YWlscyI6IHsKICAgICJ4Y29yZCI6IDI5NCwKICAgICJ5Y29yZCI6IDE3NSwKICAgICJ3aWR0aCI6IDQ5LAogICAgImhlaWdodCI6IDQ2CiAgfQp9"  
        algorithmList.Add(algorithm) 
##########################################
        request.Duration = 120
        request.Token =reservationResponse.Data.Token# "token" #reservationResponse.Data.Token
        request.Algorithms = algorithmList
        request.DeviceInfo = deviceInfo        
        #Test1 = dut.validator.QuickCapture("Test2")
        response = dut.validator.StartHighPrecisionFrameAnalysis(request)
        time.sleep(10)
        #dut.Tap(148,354)    #First video(188,159) #(265,721) Hotstar 243,807  ##nowtv (325,410)
        #dut.Tap(432,270) ###Test Nowtv
        #dut.Tap(243,807)         
        dut.Tap(70,616)  #### hotstar first selection video
        #Test1 = dut.validator.QuickCapture("Test3")
        #time.sleep(10)
#        dut.Tap(523, 530)
#        time.sleep(10)
#        dut.Tap(497, 1210)
#        time.sleep(10)
#        dut.Tap(1625, 966)
#        time.sleep(1)
#        dut.Tap(1625, 966)
        time.sleep(400)
        logger.Log("Response - " + str(response.Data)) 
        logger.Log("Response - " + response.Data.Token)        
        statusRequest = MobileScriptingLibrary.HighPrecisionValidationService.VideoAnalysisStatusRequest()
        statusRequest.Token = response.Data.Token
        statusRespose = dut.validator.GetHighPrecisionFrameAnalysisResult(statusRequest)
        logger.Log("StatusRespose - " + str(statusRespose)) 
        #dut.CommitTestResult("PASSED")

finally: 
    dut.CloseApp()

#'''''''''''''''''''''''''END AUTOGENERATED CODE''''''''''''''''''''''''''' 
#''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
